<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/controller/subsystem/gamemode - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> â€” <a href="datum/controller/subsystem/gamemode.html#var">Var Details</a> - <a href="datum/controller/subsystem/gamemode.html#proc">Proc Details</a></header><main><h1>gamemode <aside>/<a href="datum.html">datum</a>/<a href="datum/controller/subsystem.html">controller/subsystem</a>/<a href="datum/controller/subsystem/gamemode.html">gamemode</a></aside> <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L3"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 3"></a></h1><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/allow_pop_scaling">allow_pop_scaling</a></th><td>Whether we allow pop scaling. This is configured by config, or the storyteller UI</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/event_frequency_multiplier">event_frequency_multiplier</a></th><td>Event frequency multiplier, it exists because wizard, eugh.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/event_pools">event_pools</a></th><td>Associative list of control events by their track category. Compiled in Init</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/event_track_points">event_track_points</a></th><td>Associative list of even track points.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/event_tracks">event_tracks</a></th><td>List of our event tracks for fast access during for loops.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/forced_next_events">forced_next_events</a></th><td>Associative list of tracks to forced event controls. For admins to force events (though they can still invoke them freely outside of the track system)</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/last_point_gains">last_point_gains</a></th><td>Last point amount gained of each track. Those are recorded for purposes of estimating how long until next event.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/min_pop_thresholds">min_pop_thresholds</a></th><td>Minimum population thresholds for the tracks to fire off events.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/next_storyteller_process">next_storyteller_process</a></th><td>Next process for our storyteller. The wait time is STORYTELLER_WAIT_TIME</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/panel_page">panel_page</a></th><td>Page of the UI panel.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/point_gain_multipliers">point_gain_multipliers</a></th><td>Configurable multipliers for point gain over time.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/point_thresholds">point_thresholds</a></th><td>Point thresholds at which the events are supposed to be rolled, it is also the base cost for events.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/pop_data_cached">pop_data_cached</a></th><td>Whether we looked up pop info in this process tick</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/pop_scale_penalties">pop_scale_penalties</a></th><td>Associative list of pop scale penalties.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/pop_scale_thresholds">pop_scale_thresholds</a></th><td>Associative list of pop scale thresholds.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/ready_players">ready_players</a></th><td>Ready players for roundstart events.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/roundstart_event_view">roundstart_event_view</a></th><td>Whether we are viewing the roundstart events or not</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/roundstart_point_multipliers">roundstart_point_multipliers</a></th><td>Configurable multipliers for roundstart points.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/scheduled_events">scheduled_events</a></th><td>Events that we have scheduled to run in the nearby future</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/statistics_track_page">statistics_track_page</a></th><td>Current preview page for the statistics UI.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/storyteller">storyteller</a></th><td>Our storyteller. He progresses our trackboards and picks out events</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/storyteller_halted">storyteller_halted</a></th><td>Whether the storyteller has been halted</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/storytellers">storytellers</a></th><td>List of all the storytellers. Populated at init. Associative from type</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/uncategorized">uncategorized</a></th><td>List of all uncategorized events, because they were wizard or holiday events</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/voted_storyteller">voted_storyteller</a></th><td>Result of the storyteller vote. Defaults to the guide.</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/calculate_ready_players">calculate_ready_players</a></th><td>We need to calculate ready players for the sake of roundstart events becoming eligible.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/can_inject_antags">can_inject_antags</a></th><td>Whether events can inject more antagonists into the round</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/force_event">force_event</a></th><td>Schedules an event.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/force_next_event">force_next_event</a></th><td>force_next_event</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/get_antag_cap">get_antag_cap</a></th><td>Gets the number of antagonists the antagonist injection events will stop rolling after.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/get_candidates">get_candidates</a></th><td>Gets candidates for antagonist roles.
Todo: Split into get_candidates and post_get_candidates</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/get_correct_popcount">get_correct_popcount</a></th><td>Gets the correct popcount, returning READY people if roundstart, and active people if not.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/get_scheduled_by_event_type">get_scheduled_by_event_type</a></th><td>get_scheduled_by_event_type</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/halt_storyteller">halt_storyteller</a></th><td>halt_storyteller</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/handle_post_setup_roundstart_events">handle_post_setup_roundstart_events</a></th><td>Second step of handlind roundstart events, happening after people spawn.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/handle_pre_setup_roundstart_events">handle_pre_setup_roundstart_events</a></th><td>Because roundstart events need 2 steps of firing for purposes of antags, here is the first step handled, happening before occupation division.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/load_config_vars">load_config_vars</a></th><td>Loads config values from game_options.txt</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/load_event_config_vars">load_event_config_vars</a></th><td>Loads json event config values from events.txt</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/make_antag_chance">make_antag_chance</a></th><td>Handles late-join antag assignments</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/post_setup">post_setup</a></th><td>Everyone should now be on the station and have their normal gear.  This is the place to give the special roles extra things</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/pre_setup">pre_setup</a></th><td>Attempts to select players for special roles the mode might have.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/refund_scheduled_event">refund_scheduled_event</a></th><td>Refunds and removes a scheduled event.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/remove_scheduled_event">remove_scheduled_event</a></th><td>Removes a scheduled event.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/resetFrequency">resetFrequency</a></th><td>Resets frequency multiplier.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/roll_pre_setup_points">roll_pre_setup_points</a></th><td>We roll points to be spent for roundstart events, including antagonists.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/schedule_event">schedule_event</a></th><td>Schedules an event to run later.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/set_storyteller">set_storyteller</a></th><td>set_storyteller</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/allow_pop_scaling"><aside class="declaration">var </aside>allow_pop_scaling <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L71"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 71"></a></h3><p>Whether we allow pop scaling. This is configured by config, or the storyteller UI</p><h3 id="var/event_frequency_multiplier"><aside class="declaration">var </aside>event_frequency_multiplier <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L112"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 112"></a></h3><p>Event frequency multiplier, it exists because wizard, eugh.</p><h3 id="var/event_pools"><aside class="declaration">var </aside>event_pools <aside>â€“ /list</aside> <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L94"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 94"></a></h3><p>Associative list of control events by their track category. Compiled in Init</p><h3 id="var/event_track_points"><aside class="declaration">var </aside>event_track_points <aside>â€“ /list</aside> <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L21"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 21"></a></h3><p>Associative list of even track points.</p><h3 id="var/event_tracks"><aside class="declaration">var </aside>event_tracks <aside>â€“ /list</aside> <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L11"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 11"></a></h3><p>List of our event tracks for fast access during for loops.</p><h3 id="var/forced_next_events"><aside class="declaration">var </aside>forced_next_events <aside>â€“ /list</aside> <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L100"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 100"></a></h3><p>Associative list of tracks to forced event controls. For admins to force events (though they can still invoke them freely outside of the track system)</p><h3 id="var/last_point_gains"><aside class="declaration">var </aside>last_point_gains <aside>â€“ /list</aside> <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L29"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 29"></a></h3><p>Last point amount gained of each track. Those are recorded for purposes of estimating how long until next event.</p><h3 id="var/min_pop_thresholds"><aside class="declaration">var </aside>min_pop_thresholds <aside>â€“ /list</aside> <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L46"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 46"></a></h3><p>Minimum population thresholds for the tracks to fire off events.</p><h3 id="var/next_storyteller_process"><aside class="declaration">var </aside>next_storyteller_process <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L19"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 19"></a></h3><p>Next process for our storyteller. The wait time is STORYTELLER_WAIT_TIME</p><h3 id="var/panel_page"><aside class="declaration">var </aside>panel_page <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L117"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 117"></a></h3><p>Page of the UI panel.</p><h3 id="var/point_gain_multipliers"><aside class="declaration">var </aside>point_gain_multipliers <aside>â€“ /list</aside> <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L55"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 55"></a></h3><p>Configurable multipliers for point gain over time.</p><h3 id="var/point_thresholds"><aside class="declaration">var </aside>point_thresholds <aside>â€“ /list</aside> <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L37"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 37"></a></h3><p>Point thresholds at which the events are supposed to be rolled, it is also the base cost for events.</p><h3 id="var/pop_data_cached"><aside class="declaration">var </aside>pop_data_cached <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L137"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 137"></a></h3><p>Whether we looked up pop info in this process tick</p><h3 id="var/pop_scale_penalties"><aside class="declaration">var </aside>pop_scale_penalties <aside>â€“ /list</aside> <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L83"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 83"></a></h3><p>Associative list of pop scale penalties.</p><h3 id="var/pop_scale_thresholds"><aside class="declaration">var </aside>pop_scale_thresholds <aside>â€“ /list</aside> <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L74"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 74"></a></h3><p>Associative list of pop scale thresholds.</p><h3 id="var/ready_players"><aside class="declaration">var </aside>ready_players <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L125"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 125"></a></h3><p>Ready players for roundstart events.</p><h3 id="var/roundstart_event_view"><aside class="declaration">var </aside>roundstart_event_view <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L119"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 119"></a></h3><p>Whether we are viewing the roundstart events or not</p><h3 id="var/roundstart_point_multipliers"><aside class="declaration">var </aside>roundstart_point_multipliers <aside>â€“ /list</aside> <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L63"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 63"></a></h3><p>Configurable multipliers for roundstart points.</p><h3 id="var/scheduled_events"><aside class="declaration">var </aside>scheduled_events <aside>â€“ /list</aside> <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L97"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 97"></a></h3><p>Events that we have scheduled to run in the nearby future</p><h3 id="var/statistics_track_page"><aside class="declaration">var </aside>statistics_track_page <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L115"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 115"></a></h3><p>Current preview page for the statistics UI.</p><h3 id="var/storyteller"><aside class="declaration">var </aside>storyteller <aside>â€“ /<a href="datum.html">datum</a>/<a href="datum/storyteller.html">storyteller</a></aside> <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L13"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 13"></a></h3><p>Our storyteller. He progresses our trackboards and picks out events</p><h3 id="var/storyteller_halted"><aside class="declaration">var </aside>storyteller_halted <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L122"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 122"></a></h3><p>Whether the storyteller has been halted</p><h3 id="var/storytellers"><aside class="declaration">var </aside>storytellers <aside>â€“ /list</aside> <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L17"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 17"></a></h3><p>List of all the storytellers. Populated at init. Associative from type</p><h3 id="var/uncategorized"><aside class="declaration">var </aside>uncategorized <aside>â€“ /list</aside> <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L107"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 107"></a></h3><p>List of all uncategorized events, because they were wizard or holiday events</p><h3 id="var/voted_storyteller"><aside class="declaration">var </aside>voted_storyteller <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L15"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 15"></a></h3><p>Result of the storyteller vote. Defaults to the guide.</p><h2 id="proc">Proc Details</h2><h3 id="proc/calculate_ready_players"><aside class="declaration">proc </aside>calculate_ready_players<aside>()  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L340"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 340"></a></aside></h3><p>We need to calculate ready players for the sake of roundstart events becoming eligible.</p><h3 id="proc/can_inject_antags"><aside class="declaration">proc </aside>can_inject_antags<aside>()  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L252"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 252"></a></aside></h3><p>Whether events can inject more antagonists into the round</p><h3 id="proc/force_event"><aside class="declaration">proc </aside>force_event<aside>(/<a href="datum.html">datum</a>/<a href="datum/round_event_control.html">round_event_control</a>/event)  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L331"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 331"></a></aside></h3><p>Schedules an event.</p><h3 id="proc/force_next_event"><aside class="declaration">proc </aside>force_next_event<aside>(track, /<a href="mob.html">mob</a>/user)  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L865"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 865"></a></aside></h3><p>force_next_event</p>
<p>Forces next event scheduling/firing for <code>track</code></p><h3 id="proc/get_antag_cap"><aside class="declaration">proc </aside>get_antag_cap<aside>()  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L244"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 244"></a></aside></h3><p>Gets the number of antagonists the antagonist injection events will stop rolling after.</p><h3 id="proc/get_candidates"><aside class="declaration">proc </aside>get_candidates<aside>(special_role_flag, pick_observers, pick_roundstart_players, no_antags, /list/restricted_roles, /list/restricted_species)  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L258"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 258"></a></aside></h3><p>Gets candidates for antagonist roles.
Todo: Split into get_candidates and post_get_candidates</p><h3 id="proc/get_correct_popcount"><aside class="declaration">proc </aside>get_correct_popcount<aside>()  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L313"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 313"></a></aside></h3><p>Gets the correct popcount, returning READY people if roundstart, and active people if not.</p><h3 id="proc/get_scheduled_by_event_type"><aside class="declaration">proc </aside>get_scheduled_by_event_type<aside>(type)  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L881"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 881"></a></aside></h3><p>get_scheduled_by_event_type</p>
<p>Returns the scheduled event, if any, by the event's type.
Returns null if no such event exists.</p><h3 id="proc/halt_storyteller"><aside class="declaration">proc </aside>halt_storyteller<aside>(/<a href="mob.html">mob</a>/user)  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L852"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 852"></a></aside></h3><p>halt_storyteller</p>
<p>Used to halt/unhalt and properly log storyteller</p><h3 id="proc/handle_post_setup_roundstart_events"><aside class="declaration">proc </aside>handle_post_setup_roundstart_events<aside>()  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L393"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 393"></a></aside></h3><p>Second step of handlind roundstart events, happening after people spawn.</p><h3 id="proc/handle_pre_setup_roundstart_events"><aside class="declaration">proc </aside>handle_pre_setup_roundstart_events<aside>()  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L381"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 381"></a></aside></h3><p>Because roundstart events need 2 steps of firing for purposes of antags, here is the first step handled, happening before occupation division.</p><h3 id="proc/load_config_vars"><aside class="declaration">proc </aside>load_config_vars<aside>()  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L697"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 697"></a></aside></h3><p>Loads config values from game_options.txt</p><h3 id="proc/load_event_config_vars"><aside class="declaration">proc </aside>load_event_config_vars<aside>()  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L658"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 658"></a></aside></h3><p>Loads json event config values from events.txt</p><h3 id="proc/make_antag_chance"><aside class="declaration">proc </aside>make_antag_chance<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/<a href="mob/living/carbon/human.html">human</a>/character)  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L581"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 581"></a></aside></h3><p>Handles late-join antag assignments</p><h3 id="proc/post_setup"><aside class="declaration">proc </aside>post_setup<aside>(report)  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L551"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 551"></a></aside></h3><p>Everyone should now be on the station and have their normal gear.  This is the place to give the special roles extra things</p><h3 id="proc/pre_setup"><aside class="declaration">proc </aside>pre_setup<aside>()  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L542"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 542"></a></aside></h3><p>Attempts to select players for special roles the mode might have.</p><h3 id="proc/refund_scheduled_event"><aside class="declaration">proc </aside>refund_scheduled_event<aside>(/<a href="datum.html">datum</a>/<a href="datum/scheduled_event.html">scheduled_event</a>/refunded)  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L324"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 324"></a></aside></h3><p>Refunds and removes a scheduled event.</p><h3 id="proc/remove_scheduled_event"><aside class="declaration">proc </aside>remove_scheduled_event<aside>(/<a href="datum.html">datum</a>/<a href="datum/scheduled_event.html">scheduled_event</a>/removed)  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L335"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 335"></a></aside></h3><p>Removes a scheduled event.</p><h3 id="proc/resetFrequency"><aside class="declaration">proc </aside>resetFrequency<aside>()  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L471"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 471"></a></aside></h3><p>Resets frequency multiplier.</p><h3 id="proc/roll_pre_setup_points"><aside class="declaration">proc </aside>roll_pre_setup_points<aside>()  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L348"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 348"></a></aside></h3><p>We roll points to be spent for roundstart events, including antagonists.</p><h3 id="proc/schedule_event"><aside class="declaration">proc </aside>schedule_event<aside>(/<a href="datum.html">datum</a>/<a href="datum/round_event_control.html">round_event_control</a>/passed_event, passed_time, passed_cost, passed_ignore, passed_announce)  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L403"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 403"></a></aside></h3><p>Schedules an event to run later.</p><h3 id="proc/set_storyteller"><aside class="declaration">proc </aside>set_storyteller<aside>(passed_type, forced, force_ckey)  <a href="https://github.com/Bubberstation/Bubberstation/blob/6f9534245f6171fa0aa17ea887605397ec3e9719/modular_zubbers/code/modules/storyteller/gamemode.dm#L831"><img src="git.png" width="16" height="16" title="modular_zubbers/code/modules/storyteller/gamemode.dm 831"></a></aside></h3><p>set_storyteller</p>
<p>Always call this to set the storyteller
Called by the storyteller system on roundstart and after a vote finishes.
When forced via game panel, forced = TRUE, and force_ckey contains the ckey of the admin who forced it</p></main><footer>tgstation.dme <a href="https://github.com/Bubberstation/Bubberstation/tree/6f9534245f6171fa0aa17ea887605397ec3e9719">6f95342</a> (master) â€” <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>